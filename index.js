const {parse} = require('csv-parse')
const fs = require('fs')

const results = []
// fs.createReadStream("starsData.csv") //ËøôÈáåÊúâÈªòËÆ§‰∏ÄÊ¨°Ëøô‰∏™ÈÉΩÂ§öÂ∞ë 64*1024 Ë¶ÅÂéª‰ªñ‰ª¨ÁöÑÊñáÊ°£Áúã
//     .on('data', (data) => {//ÊµÅÊòØÂàÜÂâ≤ÁùÄËØª ÊâÄ‰ª•ËøôÈáåÊòØËØª‰∏ÄÊ¨°Ëß¶Âèë‰∏ÄÊ¨°data
//         results.push(data)
//     }).on('error', (err) => {
//     console.log(err)
// }).on('end', () => {
//     console.log(results)
//     console.log("done")
// });
// parse()

// fs.createReadStream("starsData.csv")
//     .pipe(parse({//Ëøô‰∏™ÊòØÊääËØªÂà∞ÁöÑcsv Êï∞ÊçÆÊï¥ÂêàÁÑ∂ÂêéÂÜçparseËæìÂá∫
//         comment: '#',//‰ª•#ÂºÄÂ§¥ÁöÑÂøΩÁï•
//         columns: true,//ÊØè‰∏ÄË°åÊòØ‰∏Ä‰∏™ÂØπË±°
//     }))
//     .on('data', (data) => {
//         results.push(data)
//     }).on('error', (err) => {
//     console.log(err)
// }).on('end', () => {
//     console.log(results)
//     console.log("done")
// });

function isHabPlanet(planet) {
    return planet['koi_disposition'] === 'CONFIRMED' &&
        planet['koi_insol'] > 0.36 &&
        planet['koi_insol'] < 1.11 &&
        planet['koi_prad'] < 1.6
}

// The parse() function emits a data event for each row of data it parses.
// The on() method is used to attach an event listener to this data event.
// Whenever a row of data is parsed,
// the callback function passed to on() is called with the parsed data as its argument.

// // Create a new parse transform stream with options
// const parseStream = parse({
//   delimiter: ',',
//   columns: true,
//   skip_empty_lines: true
// });
//
// // Pipe the readable stream to the parse stream
// readableStream.pipe(parseStream);
//
// // Listen for 'data' events on the parse stream
// parseStream.on('data', (data) => {
//   console.log(data);
// });

//üëá‰ªñËøô‰∏™ÂÆûÈôÖ‰∏äÂ±ïÂºÄÊòØ‰∏äÈù¢Ëøô‰∏™ÈÄªËæë                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     sdfasdgnszpoviqetioaxckvakXcnl;kasdfrsa                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 sdfasdgnszpoviqetioaxckvakXcnl;kasdfrsa
fs.createReadStream("starsData.csv")
    .pipe(parse({//Ëøô‰∏™ÊòØÊääËØªÂà∞ÁöÑcsv Êï∞ÊçÆÊï¥ÂêàÁÑ∂ÂêéÂÜçparseËæìÂá∫
        comment: '#',//‰ª•#ÂºÄÂ§¥ÁöÑÂøΩÁï•
        columns: true,//ÊØè‰∏ÄË°åÊòØ‰∏Ä‰∏™ÂØπË±°
    }))
    .on('data', (data) => {
        if (isHabPlanet(data)) {
            results.push(data)
        }
    }).on('error', (err) => {
    console.log(err)
}).on('end', () => {
    // console.log(results.length)
    console.log(results.map((planet)=>{
        return planet['kepler_name']
    }))
    console.log("done")
});
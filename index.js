const {parse} = require('csv-parse')
const fs = require('fs')

const results = []
// fs.createReadStream("starsData.csv") //è¿™é‡Œæœ‰é»˜è®¤ä¸€æ¬¡è¿™ä¸ªéƒ½å¤šå°‘ 64*1024 è¦åŽ»ä»–ä»¬çš„æ–‡æ¡£çœ‹
//     .on('data', (data) => {//æµæ˜¯åˆ†å‰²ç€è¯» æ‰€ä»¥è¿™é‡Œæ˜¯è¯»ä¸€æ¬¡è§¦å‘ä¸€æ¬¡data
//         results.push(data)
//     }).on('error', (err) => {
//     console.log(err)
// }).on('end', () => {
//     console.log(results)
//     console.log("done")
// });
// parse()

// fs.createReadStream("starsData.csv")
//     .pipe(parse({//è¿™ä¸ªæ˜¯æŠŠè¯»åˆ°çš„csv æ•°æ®æ•´åˆç„¶åŽå†parseè¾“å‡º
//         comment: '#',//ä»¥#å¼€å¤´çš„å¿½ç•¥
//         columns: true,//æ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªå¯¹è±¡
//     }))
//     .on('data', (data) => {
//         results.push(data)
//     }).on('error', (err) => {
//     console.log(err)
// }).on('end', () => {
//     console.log(results)
//     console.log("done")
// });

function isHabPlanet(planet) {
    return planet['koi_disposition'] === 'CONFIRMED' &&
        planet['koi_insol'] > 0.36 &&
        planet['koi_insol'] < 1.11 &&
        planet['koi_prad'] < 1.6
}

// The parse() function emits a data event for each row of data it parses.
// The on() method is used to attach an event listener to this data event.
// Whenever a row of data is parsed,
// the callback function passed to on() is called with the parsed data as its argument.

// // Create a new parse transform stream with options
// const parseStream = parse({
//   delimiter: ',',
//   columns: true,
//   skip_empty_lines: true
// });
//
// // Pipe the readable stream to the parse stream
// readableStream.pipe(parseStream);
//
// // Listen for 'data' events on the parse stream
// parseStream.on('data', (data) => {
//   console.log(data);
// });

//ðŸ‘‡ä»–è¿™ä¸ªå®žé™…ä¸Šå±•å¼€æ˜¯ä¸Šé¢è¿™ä¸ªé€»è¾‘                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     sdfasdgnszpoviqetioaxckvakXcnl;kasdfrsa                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 sdfasdgnszpoviqetioaxckvakXcnl;kasdfrsa
fs.createReadStream("starsData.csv")
    .pipe(parse({//è¿™ä¸ªæ˜¯æŠŠè¯»åˆ°çš„csv æ•°æ®æ•´åˆç„¶åŽå†parseè¾“å‡º
        comment: '#',//ä»¥#å¼€å¤´çš„å¿½ç•¥
        columns: true,//æ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªå¯¹è±¡
    }))
    .on('data', (data) => {
        if (isHabPlanet(data)) {
            results.push(data)
        }
    }).on('error', (err) => {
    console.log(err)
}).on('end', () => {
    // console.log(results.length)
    console.log(results.map((planet)=>{
        return planet['kepler_name']
    }))
    console.log("done")
});